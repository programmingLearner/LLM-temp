from transformers import AutoModel
from collections import OrderedDict

# Specify the directory to save the modified model
save_directory = 'TinyBERT_General_6L_768D_renamed'

# Load the pre-trained model
model = AutoModel.from_pretrained("huawei-noah/TinyBERT_General_6L_768D")

# Rename parameters to remove the 'bert.' prefix
new_state_dict = OrderedDict()
for key, value in model.state_dict().items():
    new_key = key.replace("bert.", "")  # Adjust this line if the prefix is different
    new_state_dict[new_key] = value

# Load the modified state dictionary back into the model
model.load_state_dict(new_state_dict)

# Save the modified model
model.save_pretrained(save_directory)

def plot_histogram(weights, layer_name):
    plt.figure()
    plt.hist(weights.flatten(), bins=100, alpha=0.75, log=True)  # Set log scale for bin count
    plt.title(f"Histogram of {layer_name}")
    plt.xlabel("Weight Value")
    plt.ylabel("Frequency (Log Scale)")
    plt.yscale('log')  # Set the y-axis to a logarithmic scale
    plt.savefig(f"{layer_name}_histogram.png")
    plt.close()
